From 084db926d1a2758ef18620439369cc6f4bd71746 Mon Sep 17 00:00:00 2001
From: Sebastian Lackner <sebastian@fds-team.de>
Date: Mon, 6 Oct 2014 05:06:06 +0200
Subject: [PATCH] dbghelp: Always check for debug symbols in BINDIR.

---
 dlls/dbghelp/Makefile.in  | 2 +-
 dlls/dbghelp/elf_module.c | 1 +
 2 files changed, 2 insertions(+), 1 deletion(-)

diff --git a/dlls/dbghelp/Makefile.in b/dlls/dbghelp/Makefile.in
index 63d2cce037a..2b0756ae2a8 100644
--- a/dlls/dbghelp/Makefile.in
+++ b/dlls/dbghelp/Makefile.in
@@ -2,7 +2,7 @@ MODULE    = dbghelp.dll
 IMPORTLIB = dbghelp
 IMPORTS   = kernelbase $(ZLIB_PE_LIBS)
 EXTRAINCL = $(ZLIB_PE_CFLAGS)
-EXTRADEFS = -D_IMAGEHLP_SOURCE_
+EXTRADEFS = -D_IMAGEHLP_SOURCE_ -DBINDIR="L\"${bindir}\""
 
 VER_FILEDESCRIPTION_STR = "Wine Image Helper"
 VER_PRODUCTVERSION      = 6,1,7601,17514
diff --git a/dlls/dbghelp/elf_module.c b/dlls/dbghelp/elf_module.c
index 81f933c76ef..556dc71a619 100644
--- a/dlls/dbghelp/elf_module.c
+++ b/dlls/dbghelp/elf_module.c
@@ -1461,6 +1461,7 @@ static BOOL elf_search_and_load_file(struct process* pcs, const WCHAR* filename,
         load_elf.elf_info    = elf_info;
 
         ret = search_unix_path(filename, process_getenv(pcs, L"LD_LIBRARY_PATH"), elf_load_file_cb, &load_elf)
+            || search_unix_path(filename, BINDIR, elf_load_file_cb, &load_elf)
             || search_dll_path(pcs, filename, IMAGE_FILE_MACHINE_UNKNOWN, elf_load_file_cb, &load_elf);
     }
 
-- 
2.51.0

